<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form action="http://localhost:3008/files" enctype="multipart/form-data" method="POST">
        <input name="file" type="file" id="file">
        <input type="submit" value="提交">
    </form>
    <input type="file" id='file'/>
        <button id="submit">上传文件</button>
        <script src="https://cdn.bootcss.com/axios/0.19.2/axios.min.js"></script>
   <script type="text/javascript">
    submit.onclick = function() {
        const file = document.getElementById('file').files[0];
        // let form = new FormData()
        // form.append('file',file)

        // axios.post('http://localhost:3008/files',form).then((res)=>{
        //     console.log(res.data)
        // })
        //xhr
        // const xhr = new XMLHttpRequest();
        // xhr.open('post','http://localhost:3008/files',true);
        // xhr.onload = function() {
        //     console.log(xhr.responseText)
        // }
        // xhr.send()

    //     fetch('http://localhost:3008/files',{
    //         method: 'POST',
    //         body: form,
    //     }).then((res)=>res.json()).then((res)=> console.log(res))
    // }
    //模仿sleep
    // async function sleep(delay){
    //     return new Promise((resolve, reject) => setTimeout(resolve, delay));
    // }

    // async function foo() {
    //     const t0 = Date.now();
    //     await sleep(1500);
    //     console.log(Date.now() - t0)
    // }
    // foo()

    // const json = {hello: 'world'};
    // const blob = new Blob([JSON.stringify(json,null,2)], {type: 'application/json'})
    //  const form = new FormData()
    //  const files = new File([blob],'1.json')
    //  form.append('file',files);
    //   axios.post('http://localhost:3008/files',form)
    //   async function randomDelay(id){
    //     const delay = Math.random() * 1000;
    //     return new Promise((resolve, reject) => setTimeout(() => {
    //         console.log(`${id} finished`);
    //         resolve(id)
    //     },delay))
    //   }

//     const bufferArray = [ 137,
//   80,
//   78,
//   71,
//   13,
//   10,
//   26,
//   10,
//   0,
//   0,
//   0,
//   13,
//   73,
//   72,
//   68,
//   82,
//   0,
//   0,
//   0,
//   1,
//   0,
//   0,
//   0,
//   1,
//   1,
//   3,
//   0,
//   0,
//   0,
//   37,
//   219,
//   86,
//   202,
//   0,
//   0,
//   0,
//   6,
//   80,
//   76,
//   84,
//   69,
//   0,
//   0,
//   255,
//   128,
//   128,
//   128,
//   76,
//   108,
//   191,
//   213,
//   0,
//   0,
//   0,
//   9,
//   112,
//   72,
//   89,
//   115,
//   0,
//   0,
//   14,
//   196,
//   0,
//   0,
//   14,
//   196,
//   1,
//   149,
//   43,
//   14,
//   27,
//   0,
//   0,
//   0,
//   10,
//   73,
//   68,
//   65,
//   84,
//   8,
//   153,
//   99,
//   96,
//   0,
//   0,
//   0,
//   2,
//   0,
//   1,
//   244,
//   113,
//   100,
//   166,
//   0,
//   0,
//   0,
//   0,
//   73,
//   69,
//   78,
//   68,
//   174,
//   66,
//   96,
//   130,
// ]
// const array = Uint8Array.from(bufferArray)
// const blob = new Blob([array],{
//     type:'image/type'
// })

// const form = new FormData()
// form.append('file',blob,'1.png')
// axios.post('http://localhost:3008/files',form)

const base64 =
  "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEUAAP+AgIBMbL/VAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==";
const byteCharacters = atob(base64);
const byteNumbers = new Array(byteCharacters.length);
for(let i = 0; i<byteCharacters.length; i++) {
     byteNumbers[i] = byteCharacters.charCodeAt(i)
}

      async function foo() {
        const t0 = Date.now();
        // const p0 =  randomDelay(0);
        // const p1 = randomDelay(1);
        // const p2 = randomDelay(2);
        // const p3 = randomDelay(3);
        // const p4 = randomDelay(4);
        // const p5 = randomDelay(5);
        // const p6 = randomDelay(6);

        const promises = Array(5).fill(null).map((_,i)=> randomDelay(i))
        // await p0;
        // await p1;
        // await p2;
        // await p3;
        // await p4;
        // await p5;
        // await p6;

        for(let p of promises){
            console.log(`awaited ${await p}`)
        }
        console.log(`${Date.now() - t0}ms elapsed`)
      }

    //   foo()

    //   const array1 = [1, 4, 9, 16];
    //     console.log(array1.map((x,i)=>x * i))

//     function addTwo(x){return x + 2}
//     function addThree(x){return x + 3}
//   function addFive(x){return x + 5}

//     async function addTen(x) {
//         for(let fn of [addTwo,addThree,addFive]){
//               x = await fn(x)
//         }
//         return x
//     }

//     addTen(9).then(console.log)

//     let p10 = new Promise((resolve,reject) => resolve(3))
//     p10.then(console.log)

//     function fooPromiseExecutor(resolve,reject){ 
//         setTimeout(reject,1000,'bar') 
//     }

//    async function foo1() {
//        await new Promise(fooPromiseExecutor)
//     }
//     foo1()
   </script> 
</body>
</html>